{{ $terms := slice }}
{{ if $.all }}
  {{ range (index $.global.Site.Taxonomies $.taxonomy).Alphabetical }}
    {{ $terms = $terms | append .Name }}
  {{ end }}
{{ else }}
  {{ $terms = index $.global.Params $.taxonomy }}
{{ end }}

{{ with $terms }}
  <ul class="{{ $.taxonomy }}{{ with $.class }} {{ . }}{{ end }}">
    {{ $len := len . }}
    {{ $lastIndex := sub $len 1 }}

    {{ range $index, $value := . }}
      {{ $params := (dict "global" $.global "taxonomy" "tags" "term" $value "property" "title") }}
      {{ $name := (partial "function/get_term_property.html" $params) }}
      <li{{ if $.useTermAsClass }} class="{{ $value }}"{{ end }}>
        <a href="{{ printf `/%s/%s/` ($.taxonomy | urlize) ($value | urlize) }}">{{ $.prefix | default "" }}{{ $name }}{{ $.suffix | default "" }}</a>{{ if lt $index $lastIndex }}{{ $.delim | default "" }}{{ end }}
      </li>
    {{ end }}
  </ul>
{{ end }}
